{"ast":null,"code":"var _jsxFileName = \"/Users/nhnent/IdeaProjects/moobe/src/main/webapps/moobe-fe/src/components/common/map/SearchCurrentButton.jsx\";\nimport React, { useEffect } from 'react';\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faSearchLocation } from \"@fortawesome/free-solid-svg-icons\";\nimport { buildContentPath, buildQuery, getSearchQueryParams, getSearchQueryText, isSimilarLocation, parsePath, updateObject } from \"data/util\";\nimport { useHistory, useLocation } from \"react-router\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { isEmpty as _isEmpty } from \"lodash\";\nimport debounce from 'lodash.debounce';\nimport queryString from \"query-string\";\nimport { setSearchOnBoundChange, setSearchOnLevelChange } from \"data/redux/action/map\";\nimport { setFocusedLocation } from \"data/redux/action/location\";\nimport { uuid } from \"bulma-extensions/bulma-carousel/src/js/utils\";\n\nconst SearchCurrentButton = () => {\n  const dispatch = useDispatch();\n  const history = useHistory();\n\n  const _useSelector = useSelector(state => state.channel),\n        activeChannel = _useSelector.activeChannel;\n\n  const _useSelector2 = useSelector(state => state.content),\n        contentList = _useSelector2.contentList,\n        contentLoading = _useSelector2.contentLoading;\n\n  const _useSelector3 = useSelector(state => state.map),\n        centerChanged = _useSelector3.centerChanged,\n        mapLoading = _useSelector3.mapLoading,\n        mapBounds = _useSelector3.mapBounds,\n        searchOnBoundChange = _useSelector3.searchOnBoundChange,\n        mapLevel = _useSelector3.mapLevel,\n        searchOnLevelChange = _useSelector3.searchOnLevelChange,\n        changedCenterLat = _useSelector3.changedCenterLat,\n        changedCenterLng = _useSelector3.changedCenterLng;\n\n  const location = useLocation();\n\n  const _queryString$parse = queryString.parse(location.search),\n        query = _queryString$parse.query,\n        searchType = _queryString$parse.searchType;\n\n  const search = e => {\n    if (e) e.target.blur();\n    dispatch(setFocusedLocation(null));\n\n    const _parsePath = parsePath(location.pathname),\n          channels = _parsePath.channels,\n          contents = _parsePath.contents; //fail over if active channel not set.\n\n\n    let queryParams = updateObject(getSearchQueryParams(query, searchType), {\n      page: 1,\n      swLat: mapBounds.sw.lat,\n      swLng: mapBounds.sw.lng,\n      neLat: mapBounds.ne.lat,\n      neLng: mapBounds.ne.lng,\n      k: uuid().substring(0, 5)\n    });\n    history.push({\n      pathname: buildContentPath(activeChannel ? activeChannel : channels ? {\n        id: channels\n      } : null, null),\n      search: buildQuery(queryParams)\n    });\n  };\n\n  const searchCurrentLocationText = () => {\n    if (!_isEmpty(query)) {\n      return \"현재 지도에서 [\" + getSearchQueryText(query, searchType) + \"] 다시 찾기\";\n    }\n\n    return \"현재 지도에서 찾기\";\n  };\n\n  const isVisible = () => {\n    if (centerChanged) {\n      if (contentLoading) {\n        return true;\n      }\n\n      if (contentList.length == 0) {\n        return false;\n      }\n\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  useEffect(() => {\n    if (searchOnBoundChange && mapBounds && !mapLoading) {\n      search();\n      dispatch(setSearchOnBoundChange(false));\n    }\n  }, [mapBounds, mapLoading]);\n  useEffect(() => {\n    if (searchOnLevelChange && mapLevel && !mapLoading) {\n      search();\n      dispatch(setSearchOnLevelChange(false));\n    }\n  }, [mapLevel, mapLoading]);\n  return React.createElement(\"button\", {\n    className: \"location-search-button button has-text-weight-semibold\" + (contentLoading ? \" is-loading\" : \"\") + (isVisible() ? \"\" : \" is-hidden\"),\n    onClick: search,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80\n    },\n    __self: this\n  }, React.createElement(\"span\", {\n    className: \"icon\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81\n    },\n    __self: this\n  }, React.createElement(FontAwesomeIcon, {\n    icon: faSearchLocation,\n    size: \"sm\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82\n    },\n    __self: this\n  })), React.createElement(\"span\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84\n    },\n    __self: this\n  }, searchCurrentLocationText()));\n};\n\nexport default SearchCurrentButton;","map":{"version":3,"sources":["/Users/nhnent/IdeaProjects/moobe/src/main/webapps/moobe-fe/src/components/common/map/SearchCurrentButton.jsx"],"names":["React","useEffect","FontAwesomeIcon","faSearchLocation","buildContentPath","buildQuery","getSearchQueryParams","getSearchQueryText","isSimilarLocation","parsePath","updateObject","useHistory","useLocation","useDispatch","useSelector","isEmpty","_isEmpty","debounce","queryString","setSearchOnBoundChange","setSearchOnLevelChange","setFocusedLocation","uuid","SearchCurrentButton","dispatch","history","state","channel","activeChannel","content","contentList","contentLoading","map","centerChanged","mapLoading","mapBounds","searchOnBoundChange","mapLevel","searchOnLevelChange","changedCenterLat","changedCenterLng","location","parse","search","query","searchType","e","target","blur","pathname","channels","contents","queryParams","page","swLat","sw","lat","swLng","lng","neLat","ne","neLng","k","substring","push","id","searchCurrentLocationText","isVisible","length"],"mappings":"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","sourcesContent":["import React, {useEffect} from 'react';\nimport {FontAwesomeIcon} from \"@fortawesome/react-fontawesome\";\nimport {faSearchLocation} from \"@fortawesome/free-solid-svg-icons\";\nimport {\n    buildContentPath,\n    buildQuery,\n    getSearchQueryParams,\n    getSearchQueryText,\n    isSimilarLocation, parsePath,\n    updateObject\n} from \"data/util\";\nimport {useHistory, useLocation} from \"react-router\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {isEmpty as _isEmpty} from \"lodash\";\nimport debounce from 'lodash.debounce'\nimport queryString from \"query-string\";\nimport {setSearchOnBoundChange, setSearchOnLevelChange} from \"data/redux/action/map\";\nimport {setFocusedLocation} from \"data/redux/action/location\";\nimport {uuid} from \"bulma-extensions/bulma-carousel/src/js/utils\";\n\nconst SearchCurrentButton = () => {\n\n    const dispatch = useDispatch();\n    const history = useHistory();\n    const {activeChannel} = useSelector(state => state.channel);\n    const {contentList, contentLoading} = useSelector(state => state.content);\n    const {centerChanged, mapLoading, mapBounds, searchOnBoundChange, mapLevel, searchOnLevelChange, changedCenterLat, changedCenterLng} = useSelector(state => state.map);\n    const location = useLocation();\n    const {query, searchType} = queryString.parse(location.search);\n\n    const search = (e) => {\n        if (e) e.target.blur();\n        dispatch(setFocusedLocation(null))\n        const {channels, contents} = parsePath(location.pathname) //fail over if active channel not set.\n        let queryParams = updateObject(getSearchQueryParams(query, searchType)\n            ,{page: 1, swLat: mapBounds.sw.lat, swLng: mapBounds.sw.lng, neLat: mapBounds.ne.lat, neLng: mapBounds.ne.lng, k: uuid().substring(0, 5)});\n        history.push({\n            pathname: buildContentPath(activeChannel ? activeChannel : channels ? {id: channels} : null, null),\n            search: buildQuery(queryParams)\n        });\n    };\n\n    const searchCurrentLocationText = () => {\n        if (!_isEmpty(query)) {\n            return \"현재 지도에서 [\" + getSearchQueryText(query, searchType) + \"] 다시 찾기\";\n        }\n        return \"현재 지도에서 찾기\"\n    }\n\n    const isVisible = () => {\n        if (centerChanged) {\n            if (contentLoading) {\n                return true\n            }\n            if (contentList.length == 0) {\n                return false\n            }\n            return true\n        } else {\n            return false\n        }\n    }\n\n    useEffect(() => {\n        if (searchOnBoundChange && mapBounds && !mapLoading) {\n            search();\n            dispatch(setSearchOnBoundChange(false))\n        }\n    }, [mapBounds, mapLoading])\n\n    useEffect(() => {\n        if (searchOnLevelChange && mapLevel && !mapLoading) {\n            search();\n            dispatch(setSearchOnLevelChange(false));\n        }\n    }, [mapLevel, mapLoading])\n\n\n    return (\n        <button className={\"location-search-button button has-text-weight-semibold\" + (contentLoading? \" is-loading\" : \"\") + (isVisible() ? \"\" : \" is-hidden\")} onClick={search}>\n            <span className=\"icon\">\n                <FontAwesomeIcon icon={faSearchLocation} size={\"sm\"} />\n            </span>\n            <span>{searchCurrentLocationText()}</span>\n        </button>\n    )\n};\n\nexport default SearchCurrentButton;"]},"metadata":{},"sourceType":"module"}