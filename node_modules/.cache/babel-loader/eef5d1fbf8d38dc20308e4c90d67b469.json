{"ast":null,"code":"import _slicedToArray from \"/Users/nhnent/IdeaProjects/moobe/src/main/webapps/moobe-fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/nhnent/IdeaProjects/moobe/src/main/webapps/moobe-fe/src/components/common/map/KakaoMap.jsx\";\nimport React, { useCallback, useEffect, useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { loadingMapFinished, loadingMapSuccess, setMapBounds, setMapLevel } from \"data/redux/action/map\";\nimport { initVH } from \"components/common/layout/WindowDimensions\";\nimport { isSimilarLocation, nullFunction } from \"data/util\";\nimport { isMobile } from \"react-device-detect\";\nexport const MapContext = React.createContext({});\n\nconst KakaoMap = props => {\n  const _useState = useState({\n    map: null,\n    kakao: props.kakao\n  }),\n        _useState2 = _slicedToArray(_useState, 2),\n        state = _useState2[0],\n        setState = _useState2[1];\n\n  const dispatch = useDispatch();\n\n  const addZoomControl = (map, kakao, zoom) => {\n    if (zoom) {\n      map.addControl(new kakao.maps.ZoomControl(), kakao.maps.ControlPosition[zoom]);\n    }\n  };\n\n  const addMapTypeControl = (map, kakao, mapType) => {\n    if (mapType) {\n      map.addControl(new kakao.maps.MapTypeControl(), kakao.maps.ControlPosition[mapType]);\n    }\n  };\n\n  const setLevel = (map, kakao, level) => {};\n\n  const setLatLngBounds = (map, kakao, bounds) => {\n    if (bounds) {\n      const latLngBounds = new kakao.maps.LatLngBounds();\n      bounds.forEach(b => {\n        latLngBounds.extend(new kakao.maps.LatLng(b.lat, b.lng));\n      });\n      map.setBounds(latLngBounds);\n    }\n  };\n\n  const handleLoaded = useCallback(node => {\n    const kakao = props.kakao,\n          onZoomChange = props.onZoomChange,\n          onCenterChange = props.onCenterChange,\n          onBoundsChange = props.onBoundsChange;\n    const _props$options = props.options,\n          lat = _props$options.lat,\n          lng = _props$options.lng,\n          level = _props$options.level,\n          zoom = _props$options.zoom,\n          mapType = _props$options.mapType,\n          bounds = _props$options.bounds;\n\n    if (state.map || node === null) {\n      return;\n    }\n\n    const map = new kakao.maps.Map(node, {\n      level: level || 9,\n      center: new kakao.maps.LatLng(lat, lng)\n    });\n    map.setCopyrightPosition(kakao.maps.CopyrightPosition.BOTTOMRIGHT, true);\n    map.setZoomable(true);\n    addZoomControl(map, kakao, zoom);\n    addMapTypeControl(map, kakao, mapType);\n    setLatLngBounds(map, kakao, bounds);\n\n    const zoomChange = () => {\n      if (onZoomChange) onZoomChange(map);\n    };\n\n    const centerChange = () => {\n      if (onCenterChange) onCenterChange(map);\n    };\n\n    const boundsChange = () => {\n      if (onBoundsChange) onBoundsChange(map);\n    };\n\n    kakao.maps.event.addListener(map, \"zoom_changed\", zoomChange);\n    kakao.maps.event.addListener(map, \"center_changed\", centerChange);\n    kakao.maps.event.addListener(map, \"bounds_changed\", boundsChange);\n    initVH(); //initial viewport height\n\n    setState({\n      map,\n      kakao\n    });\n    dispatch(loadingMapSuccess(map, node, kakao));\n    dispatch(loadingMapFinished());\n    dispatch(setMapLevel(map.getLevel()));\n\n    if (bounds) {\n      let initBounds = map.getBounds();\n      let sw = initBounds.getSouthWest(),\n          ne = initBounds.getNorthEast();\n      dispatch(setMapBounds({\n        swLat: sw.getLat(),\n        swLng: sw.getLng(),\n        neLat: ne.getLat(),\n        neLng: ne.getLng()\n      }));\n    }\n\n    return () => {\n      kakao.maps.event.removeListener(map, \"zoom_changed\", zoomChange);\n      kakao.maps.event.removeListener(map, \"center_changed\", centerChange);\n      kakao.maps.event.removeListener(map, \"bounds_changed\", boundsChange);\n    };\n  }, []);\n  useEffect(() => {\n    const _props$options2 = props.options,\n          lat = _props$options2.lat,\n          lng = _props$options2.lng,\n          refreshCenter = _props$options2.refreshCenter;\n\n    if (!state.map) {\n      return;\n    }\n\n    const map = state.map,\n          kakao = state.kakao;\n    const zoomLevel = isMobile ? 5 : 6;\n    var level = map.getLevel() > zoomLevel ? zoomLevel : map.getLevel();\n    map.setLevel(level, {\n      anchor: new kakao.maps.LatLng(lat, lng),\n      animate: true\n    });\n    setMapCenterSmooth(lat, lng, 300, () => {\n      if (!isSimilarLocation({\n        lat,\n        lng\n      }, {\n        lat: map.getCenter().getLat(),\n        lng: map.getCenter().getLng()\n      })) {\n        // if failed to move center retry panto after 0.5s\n        setMapCenterSmooth(lat, lng, 500);\n      }\n    });\n  }, [props.options.lat, props.options.lng, props.options.refreshCenter]);\n\n  const setMapCenterSmooth = (lat, lng, delay, callback = nullFunction) => {\n    if (!state.map) {\n      return;\n    }\n\n    const map = state.map,\n          kakao = state.kakao;\n    setTimeout(() => {\n      map.panTo(new kakao.maps.LatLng(lat, lng));\n      if (callback) callback();\n    }, delay);\n  };\n\n  useEffect(() => {\n    const bounds = props.options.bounds;\n\n    if (!state.map) {\n      return;\n    }\n\n    setLatLngBounds(state.map, state.kakao, bounds);\n  }, [props.options.bounds]);\n  return React.createElement(\"div\", {\n    className: props.className,\n    id: \"kakao-map\",\n    ref: handleLoaded,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134\n    },\n    __self: this\n  }, state.map === null ? null : React.createElement(MapContext.Provider, {\n    value: state,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136\n    },\n    __self: this\n  }, props.children));\n};\n\nexport default KakaoMap;","map":{"version":3,"sources":["/Users/nhnent/IdeaProjects/moobe/src/main/webapps/moobe-fe/src/components/common/map/KakaoMap.jsx"],"names":["React","useCallback","useEffect","useState","useDispatch","loadingMapFinished","loadingMapSuccess","setMapBounds","setMapLevel","initVH","isSimilarLocation","nullFunction","isMobile","MapContext","createContext","KakaoMap","props","map","kakao","state","setState","dispatch","addZoomControl","zoom","addControl","maps","ZoomControl","ControlPosition","addMapTypeControl","mapType","MapTypeControl","setLevel","level","setLatLngBounds","bounds","latLngBounds","LatLngBounds","forEach","b","extend","LatLng","lat","lng","setBounds","handleLoaded","node","onZoomChange","onCenterChange","onBoundsChange","options","Map","center","setCopyrightPosition","CopyrightPosition","BOTTOMRIGHT","setZoomable","zoomChange","centerChange","boundsChange","event","addListener","getLevel","initBounds","getBounds","sw","getSouthWest","ne","getNorthEast","swLat","getLat","swLng","getLng","neLat","neLng","removeListener","refreshCenter","zoomLevel","anchor","animate","setMapCenterSmooth","getCenter","delay","callback","setTimeout","panTo","className","children"],"mappings":"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","sourcesContent":["import React, {useCallback, useEffect, useState} from \"react\";\nimport {useDispatch} from \"react-redux\";\nimport {loadingMapFinished, loadingMapSuccess, setMapBounds, setMapLevel} from \"data/redux/action/map\";\nimport {initVH} from \"components/common/layout/WindowDimensions\";\nimport {isSimilarLocation, nullFunction} from \"data/util\";\nimport {isMobile} from \"react-device-detect\";\n\nexport const MapContext = React.createContext({});\n\nconst KakaoMap = props => {\n    const [state, setState] = useState({\n        map: null,\n        kakao: props.kakao\n    });\n    const dispatch = useDispatch();\n    const addZoomControl = (map, kakao, zoom) => {\n        if (zoom) {\n            map.addControl(\n                new kakao.maps.ZoomControl(),\n                kakao.maps.ControlPosition[zoom]\n            );\n        }\n    };\n\n    const addMapTypeControl = (map, kakao, mapType) => {\n        if (mapType) {\n            map.addControl(\n                new kakao.maps.MapTypeControl(),\n                kakao.maps.ControlPosition[mapType]\n            );\n        }\n    };\n\n    const setLevel = (map, kakao, level) => {\n\n    }\n\n    const setLatLngBounds = (map, kakao, bounds) => {\n        if (bounds) {\n            const latLngBounds = new kakao.maps.LatLngBounds();\n            bounds.forEach(b => {\n                latLngBounds.extend(new kakao.maps.LatLng(b.lat, b.lng));\n            });\n            map.setBounds(latLngBounds);\n        }\n    };\n\n\n    const handleLoaded = useCallback(node => {\n        const { kakao, onZoomChange, onCenterChange, onBoundsChange } = props;\n        const { lat, lng, level, zoom, mapType, bounds } = props.options;\n        if (state.map || node === null) {\n            return;\n        }\n\n        const map = new kakao.maps.Map(node, {\n            level: level || 9,\n            center: new kakao.maps.LatLng(lat, lng),\n        });\n        map.setCopyrightPosition(kakao.maps.CopyrightPosition.BOTTOMRIGHT, true)\n        map.setZoomable(true);\n\n        addZoomControl(map, kakao, zoom);\n        addMapTypeControl(map, kakao, mapType);\n        setLatLngBounds(map, kakao, bounds);\n\n        const zoomChange = () => {\n            if (onZoomChange) onZoomChange(map);\n        };\n        const centerChange = () => {\n            if (onCenterChange) onCenterChange(map);\n        };\n        const boundsChange = () => {\n            if (onBoundsChange) onBoundsChange(map);\n        }\n\n        kakao.maps.event.addListener(map, \"zoom_changed\", zoomChange);\n        kakao.maps.event.addListener(map, \"center_changed\", centerChange);\n        kakao.maps.event.addListener(map, \"bounds_changed\", boundsChange);\n        initVH(); //initial viewport height\n        setState({map, kakao});\n        dispatch(loadingMapSuccess(map, node, kakao));\n        dispatch(loadingMapFinished());\n        dispatch(setMapLevel(map.getLevel()))\n        if (bounds) {\n            let initBounds = map.getBounds();\n            let sw = initBounds.getSouthWest(), ne = initBounds.getNorthEast();\n            dispatch(setMapBounds({swLat: sw.getLat(), swLng: sw.getLng(), neLat: ne.getLat(), neLng: ne.getLng()}));\n        }\n        return () => {\n            kakao.maps.event.removeListener(map, \"zoom_changed\", zoomChange);\n            kakao.maps.event.removeListener(map, \"center_changed\", centerChange);\n            kakao.maps.event.removeListener(map, \"bounds_changed\", boundsChange);\n        };\n    }, []);\n\n    useEffect(() => {\n        const { lat, lng, refreshCenter } = props.options;\n        if (!state.map) {\n            return ;\n        }\n        const { map, kakao } = state;\n        const zoomLevel = isMobile ? 5 : 6\n        var level = map.getLevel() > zoomLevel ? zoomLevel : map.getLevel();\n        map.setLevel(level, {anchor: new kakao.maps.LatLng(lat, lng), animate: true});\n        setMapCenterSmooth(lat, lng, 300, () => {\n            if (!isSimilarLocation({lat, lng}, {lat: map.getCenter().getLat(), lng: map.getCenter().getLng()})) {\n                // if failed to move center retry panto after 0.5s\n                setMapCenterSmooth(lat, lng, 500)\n            }\n        })\n    }, [props.options.lat, props.options.lng, props.options.refreshCenter]);\n\n    const setMapCenterSmooth = (lat, lng, delay, callback=nullFunction) => {\n        if (!state.map) {\n            return ;\n        }\n        const { map, kakao } = state;\n        setTimeout(() => {\n            map.panTo(new kakao.maps.LatLng(lat, lng));\n            if (callback) callback()\n        }, delay);\n    }\n\n    useEffect(() => {\n        const { bounds } = props.options;\n        if (!state.map) {\n            return ;\n        }\n        setLatLngBounds(state.map, state.kakao, bounds);\n    }, [props.options.bounds]);\n\n    return (\n        <div className={props.className} id=\"kakao-map\" ref={handleLoaded}>\n            {state.map === null ? null : (\n                <MapContext.Provider value={state}>\n                    {props.children}\n                </MapContext.Provider>\n            )}\n        </div>\n    );\n};\n\nexport default KakaoMap;"]},"metadata":{},"sourceType":"module"}