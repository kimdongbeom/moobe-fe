{"ast":null,"code":"import _slicedToArray from \"/Users/nhnent/IdeaProjects/moobe/src/main/webapps/moobe-fe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/nhnent/IdeaProjects/moobe/src/main/webapps/moobe-fe/src/components/common/search/Search.jsx\";\nimport React, { useEffect, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { isEmpty as _isEmpty } from \"lodash\";\nimport { searchTypeList } from \"data/redux/action/content\";\nimport { buildContentPath, buildQuery, nullFunction } from \"data/util\";\nimport { useHistory } from \"react-router\";\n\nconst SearchBar = () => {\n  const _useSelector = useSelector(state => state.channel),\n        activeChannel = _useSelector.activeChannel;\n\n  const _useState = useState(\"\"),\n        _useState2 = _slicedToArray(_useState, 2),\n        searchText = _useState2[0],\n        setSearchText = _useState2[1];\n\n  const _useState3 = useState(false),\n        _useState4 = _slicedToArray(_useState3, 2),\n        isDropdownActive = _useState4[0],\n        setIsDropdownActive = _useState4[1];\n\n  const _useState5 = useState(0),\n        _useState6 = _slicedToArray(_useState5, 2),\n        focusedIndex = _useState6[0],\n        setFocusedIndex = _useState6[1];\n\n  const _useSelector2 = useSelector(state => state.map),\n        changedMapBounds = _useSelector2.changedMapBounds;\n\n  const history = useHistory();\n  useEffect(() => {\n    if (!isDropdownActive) {\n      setFocusedIndex(0);\n    }\n  }, [isDropdownActive]);\n\n  const handleKeyDown = e => {\n    // down 40 up 38 enter 13\n    if (e.keyCode == 40) {\n      setFocusedIndex((focusedIndex + 1) % 5);\n      e.preventDefault();\n    } else if (e.keyCode == 38) {\n      setFocusedIndex((focusedIndex + 5 - 1) % 5);\n      e.preventDefault();\n    } else if (e.keyCode == 13) {\n      search(focusedIndex);\n      e.target.blur();\n      e.preventDefault();\n    }\n  };\n\n  const handleChange = e => {\n    setSearchText(e.target.value);\n\n    if (_isEmpty(e.target.value) || e.target.value.length <= 1) {\n      setIsDropdownActive(false);\n    } else {\n      setIsDropdownActive(true);\n    }\n  };\n\n  const handleBlur = e => {\n    setTimeout(() => {\n      setIsDropdownActive(false);\n    }, 200);\n  };\n\n  const handleFocus = e => {\n    if (!_isEmpty(searchText)) {\n      setIsDropdownActive(true);\n    }\n  };\n\n  const handleDropdownClick = idx => {\n    search(idx);\n  };\n\n  const search = idx => {\n    setIsDropdownActive(false);\n    setSearchText(\"\");\n    history.push({\n      pathname: buildContentPath(activeChannel, null),\n      search: buildQuery({\n        query: searchText,\n        searchType: searchTypeList[idx].type,\n        page: 1,\n        swLat: changedMapBounds.sw.lat,\n        swLng: changedMapBounds.sw.lng,\n        neLat: changedMapBounds.ne.lat,\n        neLng: changedMapBounds.ne.lng\n      })\n    });\n  };\n\n  return React.createElement(\"div\", {\n    className: \"dropdown is-right is-full-width searchbar-dropdown \" + (isDropdownActive ? \"is-active\" : \"\"),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82\n    },\n    __self: this\n  }, React.createElement(SearchBarText, {\n    onFocus: handleFocus,\n    className: \"is-flex is-full-width dropdown-trigger\",\n    onChange: handleChange,\n    onKeyDown: handleKeyDown,\n    onBlur: handleBlur,\n    value: searchText,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"dropdown-menu is-full-width is-paddingless\",\n    id: \"dropdown-menu\",\n    role: \"menu\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"dropdown-content\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86\n    },\n    __self: this\n  }, searchTypeList.map((type, idx) => {\n    return React.createElement(\"div\", {\n      key: type.type,\n      className: \"dropdown-item searchbar-dropdown-item text-overflow-ellipsis \" + (focusedIndex === idx ? \"is-active\" : \"\"),\n      onClick: () => handleDropdownClick(idx),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"search-content-header\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92\n      },\n      __self: this\n    }, type.title, \" \"), \":\\xA0\", React.createElement(\"span\", {\n      className: \"has-text-link has-text-weight-bold\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94\n      },\n      __self: this\n    }, searchText));\n  }))));\n};\n\nconst SearchBarText = ({\n  className,\n  onChange = nullFunction,\n  onKeyDown = nullFunction,\n  onBlur = nullFunction,\n  onFocus = nullFunction,\n  value = \"\"\n}) => {\n  return React.createElement(\"div\", {\n    className: className ? className : \"\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106\n    },\n    __self: this\n  }, React.createElement(SearchBarTextChannelAddon, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"field is-full-width\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108\n    },\n    __self: this\n  }, React.createElement(\"p\", {\n    className: \"control\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109\n    },\n    __self: this\n  }, React.createElement(\"input\", {\n    className: \"input\",\n    type: \"search\",\n    value: value,\n    placeholder: \"\\uC8FC\\uC18C, \\uC74C\\uC2DD, \\uD0DC\\uADF8, \\uC81C\\uBAA9\\uC73C\\uB85C \\uAC80\\uC0C9\\uD558\\uC2E4 \\uC218 \\uC788\\uC2B5\\uB2C8\\uB2E4.\",\n    onChange: onChange,\n    onKeyDown: onKeyDown,\n    onFocus: onFocus,\n    onBlur: onBlur,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110\n    },\n    __self: this\n  }))));\n};\n\nconst SearchBarTextChannelAddon = () => {\n  const _useSelector3 = useSelector(state => state.channel),\n        activeChannel = _useSelector3.activeChannel;\n\n  return React.createElement(React.Fragment, null, activeChannel ? React.createElement(\"p\", {\n    className: \"control\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127\n    },\n    __self: this\n  }, React.createElement(\"a\", {\n    className: \"button searchbar-addon is-static has-cursor-default\",\n    style: {\n      backgroundImage: `url(${activeChannel.profileImg})`,\n      backgroundSize: \"cover\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128\n    },\n    __self: this\n  })) : null);\n};\n\nexport default SearchBar;","map":{"version":3,"sources":["/Users/nhnent/IdeaProjects/moobe/src/main/webapps/moobe-fe/src/components/common/search/Search.jsx"],"names":["React","useEffect","useState","useSelector","isEmpty","_isEmpty","searchTypeList","buildContentPath","buildQuery","nullFunction","useHistory","SearchBar","state","channel","activeChannel","searchText","setSearchText","isDropdownActive","setIsDropdownActive","focusedIndex","setFocusedIndex","map","changedMapBounds","history","handleKeyDown","e","keyCode","preventDefault","search","target","blur","handleChange","value","length","handleBlur","setTimeout","handleFocus","handleDropdownClick","idx","push","pathname","query","searchType","type","page","swLat","sw","lat","swLng","lng","neLat","ne","neLng","title","SearchBarText","className","onChange","onKeyDown","onBlur","onFocus","SearchBarTextChannelAddon","backgroundImage","profileImg","backgroundSize"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from \"react\";\nimport {useSelector} from \"react-redux\";\nimport {isEmpty as _isEmpty} from \"lodash\";\nimport {searchTypeList} from \"data/redux/action/content\";\nimport {buildContentPath, buildQuery, nullFunction} from \"data/util\";\nimport {useHistory} from \"react-router\";\n\n\nconst SearchBar = () => {\n    const {activeChannel} = useSelector(state => state.channel);\n    const [searchText, setSearchText] = useState(\"\");\n    const [isDropdownActive, setIsDropdownActive] = useState(false);\n    const [focusedIndex, setFocusedIndex] = useState(0);\n    const {changedMapBounds} = useSelector(state => state.map);\n    const history = useHistory();\n\n    useEffect(() => {\n        if (!isDropdownActive) {\n            setFocusedIndex(0);\n        }\n    }, [isDropdownActive])\n\n    const handleKeyDown = (e) => {\n        // down 40 up 38 enter 13\n        if (e.keyCode == 40) {\n            setFocusedIndex((focusedIndex + 1) % 5);\n            e.preventDefault()\n        } else if (e.keyCode == 38) {\n            setFocusedIndex((focusedIndex + 5 - 1) % 5);\n            e.preventDefault()\n        } else if (e.keyCode == 13) {\n            search(focusedIndex);\n            e.target.blur();\n            e.preventDefault()\n        }\n    };\n\n    const handleChange = (e) => {\n        setSearchText(e.target.value)\n        if (_isEmpty(e.target.value) || e.target.value.length <= 1) {\n            setIsDropdownActive(false)\n        } else {\n            setIsDropdownActive(true)\n        }\n    }\n\n    const handleBlur = (e) => {\n        setTimeout(() => {\n            setIsDropdownActive(false)\n        }, 200)\n    }\n\n    const handleFocus = (e) => {\n        if (!_isEmpty(searchText)) {\n            setIsDropdownActive(true)\n        }\n    }\n\n    const handleDropdownClick = (idx) => {\n        search(idx);\n    }\n\n    const search = (idx) => {\n        setIsDropdownActive(false)\n        setSearchText(\"\");\n        history.push({\n            pathname: buildContentPath(activeChannel, null),\n            search: buildQuery({\n                query: searchText,\n                searchType: searchTypeList[idx].type,\n                page: 1,\n                swLat: changedMapBounds.sw.lat,\n                swLng: changedMapBounds.sw.lng,\n                neLat: changedMapBounds.ne.lat,\n                neLng: changedMapBounds.ne.lng\n            })\n        });\n    }\n\n\n    return (\n        <div className={\"dropdown is-right is-full-width searchbar-dropdown \" + (isDropdownActive ? \"is-active\" : \"\")}>\n            <SearchBarText onFocus={handleFocus} className=\"is-flex is-full-width dropdown-trigger\" onChange={handleChange} onKeyDown={handleKeyDown}\n                           onBlur={handleBlur} value={searchText}/>\n            <div className=\"dropdown-menu is-full-width is-paddingless\" id=\"dropdown-menu\" role=\"menu\">\n                <div className=\"dropdown-content\">\n                    {searchTypeList.map((type, idx) => {\n                        return (\n                            <div key={type.type}\n                                 className={\"dropdown-item searchbar-dropdown-item text-overflow-ellipsis \" + (focusedIndex === idx ? \"is-active\" : \"\")}\n                                 onClick={() => handleDropdownClick(idx)}>\n                                <span className=\"search-content-header\">{type.title} </span>\n                                :&nbsp;\n                                <span className=\"has-text-link has-text-weight-bold\">{searchText}</span>\n                            </div>\n                        )\n                    })}\n                </div>\n            </div>\n        </div>\n    )\n}\n\nconst SearchBarText = ({className, onChange=nullFunction, onKeyDown=nullFunction, onBlur=nullFunction, onFocus=nullFunction, value = \"\"}) => {\n    return (\n        <div className={className ? className : \"\"}>\n            <SearchBarTextChannelAddon/>\n            <div className=\"field is-full-width\">\n            <p className=\"control\">\n                <input className=\"input\" type=\"search\" value={value}\n                       placeholder=\"주소, 음식, 태그, 제목으로 검색하실 수 있습니다.\"\n                       onChange={onChange}\n                       onKeyDown={onKeyDown}\n                       onFocus={onFocus}\n                       onBlur={onBlur}/>\n            </p>\n            </div>\n        </div>\n    )\n};\n\nconst SearchBarTextChannelAddon = () => {\n    const {activeChannel} = useSelector(state => state.channel);\n    return (\n        <>\n            {activeChannel\n                ? <p className=\"control\">\n                    <a className=\"button searchbar-addon is-static has-cursor-default\"\n                       style={{backgroundImage: `url(${activeChannel.profileImg})`, backgroundSize: \"cover\"}} />\n                </p>\n                : null}\n        </>\n    )\n};\n\nexport default SearchBar;"]},"metadata":{},"sourceType":"module"}